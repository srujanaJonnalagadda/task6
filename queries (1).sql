-- Create table
CREATE TABLE online_sales (
    order_id INT AUTO_INCREMENT PRIMARY KEY,
    order_date DATE NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    product_id VARCHAR(10) NOT NULL
);

-- Insert data
INSERT INTO online_sales (order_date, amount, product_id) VALUES
('2024-01-15', 89.99, 'P001'),
('2024-01-15', 149.50, 'P003'),
('2024-01-16', 29.99, 'P005'),
('2024-01-16', 199.00, 'P002'),
('2024-01-17', 79.95, 'P007'),
('2024-01-17', 45.00, 'P001'),
('2024-01-18', 299.99, 'P004'),
('2024-01-18', 25.50, 'P008'),
('2024-01-19', 119.99, 'P006'),
('2024-01-19', 89.99, 'P001'),
('2024-01-20', 159.00, 'P003'),
('2024-01-21', 35.75, 'P009'),
('2024-01-22', 249.99, 'P010'),
('2024-01-22', 89.99, 'P001'),
('2024-01-23', 69.50, 'P005'),
('2024-01-24', 179.99, 'P002'),
('2024-01-25', 99.00, 'P011'),
('2024-01-26', 449.99, 'P012'),
('2024-01-27', 59.99, 'P007'),
('2024-01-28', 125.00, 'P013'),
('2024-01-29', 89.99, 'P001'),
('2024-01-30', 199.50, 'P003'),
('2024-02-01', 39.99, 'P014'),
('2024-02-02', 299.00, 'P004'),
('2024-02-03', 75.50, 'P015'),
('2024-02-04', 149.99, 'P006'),
('2024-02-05', 29.99, 'P005'),
('2024-02-06', 219.99, 'P016'),
('2024-02-07', 89.99, 'P001'),
('2024-02-08', 169.00, 'P017'),
('2024-02-09', 95.75, 'P018'),
('2024-02-10', 399.99, 'P019'),
('2024-02-11', 55.00, 'P020'),
('2024-02-12', 129.99, 'P021'),
('2024-02-13', 199.00, 'P002'),
('2024-02-14', 349.99, 'P022'),
('2024-02-15', 79.95, 'P007'),
('2024-02-16', 119.50, 'P023'),
('2024-02-17', 89.99, 'P001'),
('2024-02-18', 259.99, 'P024'),
('2024-02-19', 45.00, 'P025'),
('2024-02-20', 179.99, 'P026'),
('2024-02-21', 99.99, 'P027'),
('2024-02-22', 329.00, 'P028'),
('2024-02-23', 149.50, 'P003'),
('2024-02-24', 69.99, 'P029'),
('2024-02-25', 189.99, 'P030'),
('2024-02-26', 125.50, 'P031'),
('2024-02-27', 299.99, 'P004'),
('2024-02-28', 89.99, 'P001'),
('2024-03-01', 159.00, 'P032'),
('2024-03-02', 79.50, 'P033'),
('2024-03-03', 249.99, 'P034'),
('2024-03-04', 119.99, 'P006'),
('2024-03-05', 199.00, 'P002'),
('2024-03-06', 89.99, 'P001'),
('2024-03-07', 359.99, 'P035'),
('2024-03-08', 65.00, 'P036'),
('2024-03-09', 149.99, 'P037'),
('2024-03-10', 229.50, 'P038'),
('2024-03-11', 99.00, 'P039'),
('2024-03-12', 179.99, 'P040'),
('2024-03-13', 89.99, 'P001'),
('2024-03-14', 299.00, 'P041'),
('2024-03-15', 125.75, 'P042'),
('2024-03-16', 199.99, 'P043'),
('2024-03-17', 79.95, 'P007'),
('2024-03-18', 449.99, 'P044'),
('2024-03-19', 155.00, 'P045'),
('2024-03-20', 89.99, 'P001'),
('2024-03-21', 269.99, 'P046'),
('2024-03-22', 119.50, 'P047'),
('2024-03-23', 349.00, 'P048'),
('2024-03-24', 99.99, 'P049'),
('2024-03-25', 189.99, 'P050'),
('2024-03-26', 149.50, 'P003'),
('2024-03-27', 229.99, 'P051'),
('2024-03-28', 79.00, 'P052'),
('2024-03-29', 399.99, 'P053'),
('2024-03-30', 125.00, 'P054'),
('2024-03-31', 89.99, 'P001'),
('2024-04-01', 199.50, 'P055'),
('2024-04-02', 159.99, 'P056'),
('2024-04-03', 299.00, 'P057'),
('2024-04-04', 69.95, 'P058'),
('2024-04-05', 249.99, 'P059'),
('2024-04-06', 89.99, 'P001'),
('2024-04-07', 179.00, 'P060'),
('2024-04-08', 119.99, 'P061'),
('2024-04-09', 329.99, 'P062'),
('2024-04-10', 95.50, 'P063'),
('2024-04-11', 149.99, 'P064'),
('2024-04-12', 199.00, 'P002'),
('2024-04-13', 89.99, 'P001'),
('2024-04-14', 259.50, 'P065'),
('2024-04-15', 125.75, 'P066'),
('2024-04-16', 349.99, 'P067'),
('2024-04-17', 79.99, 'P068'),
('2024-04-18', 189.00, 'P069'),
('2024-04-19', 99.99, 'P070'),
('2024-04-20', 229.99, 'P071'),
('2024-04-21', 149.50, 'P003'),
('2024-04-22', 299.99, 'P072'),
('2024-04-23', 89.99, 'P001'),
('2024-04-24', 169.00, 'P073'),
('2024-04-25', 119.95, 'P074'),
('2024-04-26', 399.99, 'P075'),
('2024-04-27', 155.50, 'P076'),
('2024-04-28', 249.00, 'P077'),
('2024-04-29', 89.99, 'P001'),
('2024-04-30', 179.99, 'P078');


SELECT 
    order_id,
    order_date,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(YEAR FROM order_date) AS year
FROM online_sales;


SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales
GROUP BY year, month;


SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales
GROUP BY year, month
ORDER BY year DESC, month DESC;


SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales
WHERE order_date BETWEEN '2024-02-01' AND '2024-02-29'
GROUP BY year, month
ORDER BY year DESC, month DESC;


SELECT
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales
GROUP BY year, month
ORDER BY total_revenue DESC
LIMIT 5;


SELECT
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales;



